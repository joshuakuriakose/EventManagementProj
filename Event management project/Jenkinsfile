pipeline {
    agent { label 'DESKTOP-PNDAH72' }  // Use your Windows agent label here

    stages {
        stage('Declarative: Checkout SCM') {
            steps {
                checkout scm  // Checkout code from your Git repository
            }
        }
        
        stage('Start Apache Server') {
            steps {
                echo 'üöÄ Starting Apache Server...'
                bat '''
                echo Checking if Apache is already running...
                tasklist /FI "IMAGENAME eq httpd.exe" | find /I "httpd.exe"
                if errorlevel 1 (
                    echo Apache not running. Attempting to start...
                    "C:\\xampp\\apache\\bin\\httpd.exe"
                ) else (
                    echo Apache already running.
                )
                '''
            }
        }

        stage('Checkout Code') {
            steps {
                echo 'üìÇ Checking out the code...'
                checkout scm  // Checkout code again if necessary, but it's already done in the first stage
            }
        }

        stage('PHP Lint Check') {
            steps {
                echo 'üîç Running PHP lint check...'
                bat 'php -l .\\path\\to\\your\\php\\files\\*.php'  // Add path to your PHP files for lint check
            }
        }

        stage('Deploy to XAMPP') {
            steps {
                echo 'üöÄ Deploying to XAMPP...'
                bat '''
                copy .\\path\\to\\your\\project\\files\\* "C:\\xampp\\htdocs\\your_project\\"
                '''
            }
        }

        stage('Open in Browser') {
            steps {
                echo 'üåê Opening the site in the browser...'
                bat 'start http://localhost/your_project'  // Open the site in the browser
            }
        }
    }

    post {
        always {
            echo '‚úîÔ∏è Pipeline finished'
        }
        success {
            echo '‚úÖ Build succeeded!'
        }
        failure {
            echo '‚ùå Build failed!'
        }
    }
}
